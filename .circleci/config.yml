version: 2.1
orbs:
  node: circleci/node@5.0.2

jobs:
  Fetch-Code:
    docker:
      - image: cimg/node:14.20.0
    steps:
      - checkout
  Install-Deps:
    docker:
      - image: cimg/node:14.20.0
    steps:
      - node/install-packages
  node/test:
    docker:
      - image: cimg/node:14.20.0
    steps:
      - test-results-for: jest

workflows:
  Test:
    jobs:
      - Fetch-Code
      - Install-Deps
      - node/test:
          requires:
            - Fetch-Code
            - Install-Deps